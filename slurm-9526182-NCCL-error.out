r0 master: gra1158
r0 Launching python script
Found total gpus 4
Found total gpus 4
2023-07-18 14:10:07,292 - Added key: store_based_barrier_key:1 to store for rank: 2
2023-07-18 14:10:07,332 - Added key: store_based_barrier_key:1 to store for rank: 3
2023-07-18 14:10:07,361 - Added key: store_based_barrier_key:1 to store for rank: 1
2023-07-18 14:10:07,409 - Added key: store_based_barrier_key:1 to store for rank: 0
2023-07-18 14:10:07,947 - Added key: store_based_barrier_key:1 to store for rank: 3
2023-07-18 14:10:07,981 - Added key: store_based_barrier_key:1 to store for rank: 2
2023-07-18 14:10:07,996 - Added key: store_based_barrier_key:1 to store for rank: 0
2023-07-18 14:10:08,007 - Added key: store_based_barrier_key:1 to store for rank: 1
2023-07-18 14:10:08,007 - Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-07-18 14:10:08,008 - Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-07-18 14:10:08,010 - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-07-18 14:10:08,012 - Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-07-18 14:10:08,014 - Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-07-18 14:10:08,014 - Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-07-18 14:10:08,017 - Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-07-18 14:10:08,016 - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2  gpu 2
image size is:
96 96 96
Total parameters count 62191941
3  gpu 3
image size is:
96 96 96
Total parameters count 62191941
Traceback (most recent call last):
  File "/home/guest183/research-contributions/SwinUNETR/BRATS21/main.py", line 237, in <module>
    main()
  File "/home/guest183/research-contributions/SwinUNETR/BRATS21/main.py", line 105, in main
    mp.spawn(main_worker, nprocs=args.ngpus_per_node, args=(args,))
  File "/home/guest183/run_swinUNETR_kilimanjaro/SWIN_ENV/lib/python3.9/site-packages/torch/multiprocessing/spawn.py", line 240, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/home/guest183/run_swinUNETR_kilimanjaro/SWIN_ENV/lib/python3.9/site-packages/torch/multiprocessing/spawn.py", line 198, in start_processes
    while not context.join():
  File "/home/guest183/run_swinUNETR_kilimanjaro/SWIN_ENV/lib/python3.9/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 2 terminated with the following error:
Traceback (most recent call last):
  File "/home/guest183/run_swinUNETR_kilimanjaro/SWIN_ENV/lib/python3.9/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/home/guest183/research-contributions/SwinUNETR/BRATS21/main.py", line 193, in main_worker
    model = torch.nn.parallel.DistributedDataParallel(model, device_ids=[args.gpu], output_device=args.gpu)
  File "/home/guest183/run_swinUNETR_kilimanjaro/SWIN_ENV/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 655, in __init__
    _verify_param_shape_across_processes(self.process_group, parameters)
  File "/home/guest183/run_swinUNETR_kilimanjaro/SWIN_ENV/lib/python3.9/site-packages/torch/distributed/utils.py", line 112, in _verify_param_shape_across_processes
    return dist._verify_params_across_processes(process_group, tensors, logger)
RuntimeError: NCCL error in: /home/coulombc/wheels_builder/tmp.17383/python-3.9/torch/torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1269, unhandled system error, NCCL version 2.11.4
ncclSystemError: System call (e.g. socket, malloc) or external library call failed or device error. It can be also caused by unexpected exit of a remote peer.

srun: error: gra1158: task 0: Exited with exit code 1
srun: launch/slurm: _step_signal: Terminating StepId=9526182.0
srun: error: gra1159: task 1: Terminated
srun: Force Terminated StepId=9526182.0
